<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Solar Irradiance Predictor</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            min-height: calc(100vh - 40px);
        }
        
        .header {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: clamp(1.8em, 4vw, 2.8em);
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            line-height: 1.2;
        }
        
        .header p {
            font-size: clamp(1em, 2vw, 1.3em);
            opacity: 0.9;
        }
        
        .content {
            padding: clamp(20px, 4vw, 40px);
        }
        
        .location-input {
            background: #f8f9fa;
            padding: clamp(20px, 3vw, 30px);
            border-radius: 15px;
            margin-bottom: 30px;
        }
        
        .location-input h3 {
            margin-bottom: clamp(15px, 2vw, 20px);
            color: #2d3436;
            font-size: clamp(1.2em, 2.5vw, 1.5em);
            text-align: center;
        }
        
        .input-group {
            display: flex;
            gap: 20px;
            align-items: end;
            flex-wrap: wrap;
        }
        
        .input-row {
            display: flex;
            gap: 15px;
            flex: 2;
            min-width: 250px;
        }
        
        .input-field {
            flex: 1;
            min-width: 120px;
        }
        
        .input-field label {
            display: block;
            font-weight: 600;
            color: #2d3436;
            margin-bottom: 8px;
            font-size: clamp(0.9em, 1.5vw, 1em);
        }
        
        .input-field input {
            width: 100%;
            padding: clamp(12px, 2vw, 16px);
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            background: white;
            transition: all 0.3s ease;
        }
        
        .input-field input:focus {
            outline: none;
            border-color: #007cba;
            box-shadow: 0 0 0 3px rgba(0,124,186,0.1);
        }
        
        .predict-btn {
            background: linear-gradient(135deg, #007cba 0%, #005a87 100%);
            color: white;
            border: none;
            padding: clamp(14px, 2vw, 18px) clamp(20px, 3vw, 30px);
            font-size: clamp(16px, 1.8vw, 18px);
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,124,186,0.3);
            flex: 1;
            min-width: 200px;
            touch-action: manipulation;
        }
        
        .predict-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,124,186,0.4);
        }
        
        .predict-btn:active {
            transform: translateY(0);
        }
        
        .predict-btn:disabled {
            background: #cccccc;
            transform: none;
            box-shadow: none;
            cursor: not-allowed;
        }
        
        .status {
            padding: clamp(15px, 2vw, 20px);
            margin: 20px 0;
            border-radius: 10px;
            text-align: center;
            font-size: clamp(1em, 1.5vw, 1.1em);
            line-height: 1.4;
        }
        
        .loading {
            background: #fff3cd;
            border: 2px solid #ffeaa7;
            color: #856404;
        }
        
        .success {
            background: #d1ecf1;
            border: 2px solid #bee5eb;
            color: #0c5460;
        }
        
        .error {
            background: #f8d7da;
            border: 2px solid #f5c6cb;
            color: #721c24;
        }
        
        .results {
            background: white;
            padding: clamp(20px, 3vw, 30px);
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        
        .chart-container {
            height: clamp(300px, 40vw, 500px);
            margin: clamp(20px, 3vw, 30px) 0;
            position: relative;
        }
        
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: clamp(12px, 2vw, 20px);
            margin: clamp(20px, 3vw, 30px) 0;
        }
        
        .card {
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            color: white;
            padding: clamp(20px, 2.5vw, 25px);
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(116,185,255,0.3);
            transition: transform 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card h4 {
            font-size: clamp(0.9em, 1.5vw, 1.1em);
            margin-bottom: clamp(8px, 1vw, 10px);
            opacity: 0.9;
        }
        
        .card .value {
            font-size: clamp(1.4em, 3vw, 2em);
            font-weight: bold;
            margin: clamp(5px, 1vw, 10px) 0;
        }
        
        .card .unit {
            font-size: clamp(0.8em, 1.2vw, 0.9em);
            opacity: 0.8;
        }
        
        .hourly-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(clamp(150px, 20vw, 220px), 1fr));
            gap: clamp(10px, 1.5vw, 15px);
            margin-top: clamp(20px, 3vw, 30px);
        }
        
        .hourly-card {
            background: #f8f9fa;
            padding: clamp(12px, 1.5vw, 15px);
            border-radius: 10px;
            border-left: 4px solid #007cba;
            transition: all 0.3s ease;
            font-size: clamp(0.8em, 1.2vw, 0.9em);
        }
        
        .hourly-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .hourly-card .time {
            font-weight: bold;
            color: #2d3436;
            margin-bottom: clamp(6px, 1vw, 8px);
            font-size: clamp(0.9em, 1.3vw, 1em);
        }
        
        .hourly-card .irradiance {
            font-size: clamp(1em, 1.8vw, 1.3em);
            font-weight: bold;
            color: #e17055;
            margin: clamp(4px, 0.8vw, 5px) 0;
        }
        
        .weather-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: clamp(4px, 0.8vw, 8px);
            font-size: clamp(0.7em, 1.1vw, 0.85em);
            color: #636e72;
        }
        
        /* Mobile-specific optimizations */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                border-radius: 15px;
                min-height: calc(100vh - 20px);
            }
            
            .header {
                padding: 25px 20px;
            }
            
            .input-group {
                flex-direction: column;
                gap: 15px;
            }
            
            .input-row {
                width: 100%;
                min-width: auto;
            }
            
            .predict-btn {
                min-width: 100%;
                width: 100%;
            }
            
            .summary-cards {
                grid-template-columns: 1fr;
            }
            
            .hourly-grid {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            }
        }
        
        @media (max-width: 480px) {
            .content {
                padding: 15px;
            }
            
            .location-input {
                padding: 15px;
            }
            
            .input-row {
                flex-direction: column;
                gap: 10px;
            }
            
            .hourly-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* Desktop-specific enhancements */
        @media (min-width: 1200px) {
            .summary-cards {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .hourly-grid {
                grid-template-columns: repeat(6, 1fr);
            }
        }
        
        @media (min-width: 1600px) {
            .hourly-grid {
                grid-template-columns: repeat(8, 1fr);
            }
        }
        
        /* Prevent text selection on interactive elements */
        button, input {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        /* Smooth scrolling */
        html {
            -webkit-overflow-scrolling: touch;
            scroll-behavior: smooth;
        }
        
        /* Loading animation */
        .pulse {
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        /* Focus styles for accessibility */
        button:focus-visible, input:focus-visible {
            outline: 2px solid #007cba;
            outline-offset: 2px;
        }
    </style>
    <!-- Include Chart.js for graphs -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1> SOLAR IRRADIANCE PREDICTOR</h1>
            <p>AI-powered solar energy forecasting for mobile and desktop</p>
        </div>
        
        <div class="content">
            <div class="location-input">
                <h3>üìç ENTER LOCATION COORDINATES</h3>
                <div class="input-group">
                    <div class="input-row">
                        <div class="input-field">
                            <label>Latitude</label>
                            <input type="number" id="latitude" value="40.7128" step="0.0001" placeholder="e.g., 40.7128">
                        </div>
                        <div class="input-field">
                            <label>Longitude</label>
                            <input type="number" id="longitude" value="-74.0060" step="0.0001" placeholder="e.g., -74.0060">
                        </div>
                    </div>
                    <button class="predict-btn" onclick="runPrediction()">
                        üöÄ PREDICT SOLAR IRRADIANCE
                    </button>
                </div>
                <div style="margin-top: 15px; font-size: clamp(0.8em, 1.2vw, 0.9em); color: #666; text-align: center;">
                    <em>Try: NYC (40.7128, -74.0060) | London (51.5074, -0.1278) | Tokyo (35.6762, 139.6503)</em>
                </div>
            </div>

            <div id="status" class="status">
                Ready to predict! Enter coordinates and click the button above.
            </div>

            <div id="results" class="results" style="display: none;">
                <h2 style="text-align: center; margin-bottom: clamp(20px, 3vw, 30px); color: #2d3436; font-size: clamp(1.3em, 2.5vw, 1.8em);">üìà 24-HOUR SOLAR FORECAST</h2>
                
                <div class="summary-cards">
                    <div class="card">
                        <h4>PEAK IRRADIANCE</h4>
                        <div class="value" id="peakValue">0</div>
                        <div class="unit" id="peakTime">-</div>
                    </div>
                    <div class="card">
                        <h4> DAILY AVERAGE</h4>
                        <div class="value" id="avgValue">0</div>
                        <div class="unit">W/m¬≤</div>
                    </div>
                    <div class="card">
                        <h4> TOTAL ENERGY</h4>
                        <div class="value" id="energyValue">0</div>
                        <div class="unit">kWh/m¬≤</div>
                    </div>
                    <div class="card">
                        <h4> OPTIMAL HOURS</h4>
                        <div class="value" id="optimalHours">0</div>
                        <div class="unit">hours > 500W/m¬≤</div>
                    </div>
                </div>

                <div class="chart-container">
                    <canvas id="predictionChart"></canvas>
                </div>

                <h3 style="margin: clamp(20px, 3vw, 30px) 0 clamp(12px, 2vw, 15px) 0; color: #2d3436; font-size: clamp(1.1em, 2vw, 1.4em);">üïê HOURLY BREAKDOWN</h3>
                <div id="hourlyData" class="hourly-grid"></div>
            </div>
        </div>
    </div>

    <script>
        let predictionChart = null;

        async function runPrediction() {
            const statusEl = document.getElementById('status');
            const resultsEl = document.getElementById('results');
            const predictBtn = document.querySelector('.predict-btn');
            const latitude = parseFloat(document.getElementById('latitude').value);
            const longitude = parseFloat(document.getElementById('longitude').value);

            // Validate coordinates
            if (!latitude || !longitude || Math.abs(latitude) > 90 || Math.abs(longitude) > 180) {
                statusEl.className = 'status error';
                statusEl.innerHTML = ' Please enter valid coordinates (Latitude: -90 to 90, Longitude: -180 to 180)';
                return;
            }

            try {
                predictBtn.disabled = true;
                predictBtn.textContent = 'üîÑ Processing...';
                statusEl.className = 'status loading pulse';
                statusEl.innerHTML = ' Fetching weather data...';

                // Fetch weather data
                const weatherData = await fetchWeatherData(latitude, longitude);
                if (!weatherData) {
                    predictBtn.disabled = false;
                    predictBtn.textContent = ' PREDICT SOLAR IRRADIANCE';
                    return;
                }

                statusEl.className = 'status loading pulse';
                statusEl.innerHTML = ' Generating predictions...';

                // Simulate processing time
                await new Promise(resolve => setTimeout(resolve, 800));

                // Generate predictions
                const predictions = generatePredictionsFromWeather(weatherData);
                
                // Display results
                displayResults(predictions, weatherData);
                resultsEl.style.display = 'block';
                
                statusEl.className = 'status success';
                statusEl.innerHTML = ' Predictions complete! Solar forecast ready.';
                predictBtn.disabled = false;
                predictBtn.textContent = ' PREDICT SOLAR IRRADIANCE';

            } catch (error) {
                statusEl.className = 'status error';
                statusEl.innerHTML = ` Error: ${error.message}`;
                predictBtn.disabled = false;
                predictBtn.textContent = ' PREDICT SOLAR IRRADIANCE';
                console.error('Error:', error);
            }
        }

        async function fetchWeatherData(latitude, longitude) {
            try {
                const response = await fetch(
                    `https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&hourly=temperature_2m,relative_humidity_2m,wind_speed_10m,surface_pressure,cloud_cover&timezone=auto&forecast_days=2`
                );
                
                if (!response.ok) throw new Error('Weather data unavailable');
                return await response.json();
                
            } catch (error) {
                document.getElementById('status').className = 'status error';
                document.getElementById('status').innerHTML = ' Failed to fetch weather data. Please check your connection and try again.';
                return null;
            }
        }

        function generatePredictionsFromWeather(weatherData) {
            const predictions = [];
            const hourly = weatherData.hourly;
            
            for (let i = 0; i < 24; i++) {
                const temp = hourly.temperature_2m[i];
                const humidity = hourly.relative_humidity_2m[i];
                const wind = hourly.wind_speed_10m[i];
                const pressure = hourly.surface_pressure[i];
                const clouds = hourly.cloud_cover[i];
                const hour = new Date(hourly.time[i]).getHours();
                
                const irradiance = calculateIrradiance(temp, humidity, wind, pressure, clouds, hour);
                predictions.push(irradiance);
            }
            
            return predictions;
        }

        function calculateIrradiance(temp, humidity, wind, pressure, clouds, hour) {
            let irradiance = 1000;
            
            // Time of day effect
            const solarNoon = 12;
            const hourAngle = (hour - solarNoon) * 15;
            const solarAltitude = 90 - Math.abs(hourAngle);
            const altitudeFactor = Math.max(0, Math.sin(solarAltitude * Math.PI / 180));
            irradiance *= altitudeFactor;
            
            // Cloud cover effect
            irradiance *= (1 - (clouds / 100) * 0.8);
            
            // Humidity effect
            irradiance *= (1 - (humidity / 100) * 0.3);
            
            // Atmospheric pressure effect
            const pressureFactor = 0.9 + (pressure - 1013) / 1013 * 0.2;
            irradiance *= pressureFactor;
            
            // Add some realistic noise
            const noise = (Math.random() - 0.5) * 50;
            irradiance += noise;
            
            return Math.max(0, Math.min(1000, Math.round(irradiance)));
        }

        function displayResults(predictions, weatherData) {
            updateSummaryCards(predictions, weatherData);
            createChart(predictions, weatherData);
            createHourlyGrid(predictions, weatherData);
        }

        function updateSummaryCards(predictions, weatherData) {
            const maxIrradiance = Math.max(...predictions);
            const avgIrradiance = predictions.reduce((a, b) => a + b, 0) / predictions.length;
            const totalEnergy = (avgIrradiance * 24 / 1000);
            const optimalHours = predictions.filter(p => p > 500).length;
            
            const maxIndex = predictions.indexOf(maxIrradiance);
            const maxTime = new Date(weatherData.hourly.time[maxIndex]).toLocaleTimeString('en-US', { 
                hour: 'numeric', 
                hour12: true 
            });

            document.getElementById('peakValue').textContent = `${maxIrradiance} W/m¬≤`;
            document.getElementById('peakTime').textContent = `at ${maxTime}`;
            document.getElementById('avgValue').textContent = `${avgIrradiance.toFixed(0)} W/m¬≤`;
            document.getElementById('energyValue').textContent = totalEnergy.toFixed(1);
            document.getElementById('optimalHours').textContent = optimalHours;
        }

        function createChart(predictions, weatherData) {
            const ctx = document.getElementById('predictionChart').getContext('2d');
            const times = weatherData.hourly.time.slice(0, 24).map(time => 
                new Date(time).toLocaleTimeString('en-US', { hour: 'numeric', hour12: true })
            );

            if (predictionChart) {
                predictionChart.destroy();
            }

            predictionChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: times,
                    datasets: [{
                        label: 'SOLAR IRRADIANCE (W/m¬≤)',
                        data: predictions,
                        borderColor: '#ff6b6b',
                        backgroundColor: 'rgba(255, 107, 107, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#ff6b6b',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 4,
                        pointHoverRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                font: { 
                                    size: window.innerWidth < 768 ? 12 : 14,
                                    weight: 'bold'
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(45, 52, 54, 0.9)',
                            titleFont: { size: window.innerWidth < 768 ? 12 : 14 },
                            bodyFont: { size: window.innerWidth < 768 ? 12 : 14 },
                            padding: 10,
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'SOLAR IRRADIANCE (W/m¬≤)',
                                font: { 
                                    size: window.innerWidth < 768 ? 12 : 14,
                                    weight: 'bold'
                                }
                            }
                        },
                        x: {
                            ticks: {
                                maxRotation: window.innerWidth < 768 ? 45 : 0,
                                font: { size: window.innerWidth < 768 ? 10 : 12 }
                            }
                        }
                    }
                }
            });
        }

        function createHourlyGrid(predictions, weatherData) {
            const hourlyDataEl = document.getElementById('hourlyData');
            let html = '';
            
            const times = weatherData.hourly.time.slice(0, 24);
            const temps = weatherData.hourly.temperature_2m.slice(0, 24);
            const humidity = weatherData.hourly.relative_humidity_2m.slice(0, 24);
            const clouds = weatherData.hourly.cloud_cover.slice(0, 24);

            times.forEach((time, i) => {
                const prediction = predictions[i];
                const timeStr = new Date(time).toLocaleTimeString('en-US', { 
                    hour: 'numeric', 
                    hour12: true 
                });
                
                // Color code based on irradiance intensity
                const intensity = prediction > 700 ? 'high' : prediction > 400 ? 'medium' : 'low';
                const color = intensity === 'high' ? '#e17055' : intensity === 'medium' ? '#fdcb6e' : '#b2bec3';
                
                html += `
                    <div class="hourly-card">
                        <div class="time">${timeStr}</div>
                        <div class="irradiance" style="color: ${color}">${prediction} W/m¬≤</div>
                        <div class="weather-info">
                            <span> ${temps[i].toFixed(1)}¬∞C</span>
                            <span> ${humidity[i]}%</span>
                            <span> ${clouds[i]}%</span>
                            <span> ${weatherData.hourly.wind_speed_10m[i].toFixed(1)} m/s</span>
                        </div>
                    </div>
                `;
            });
            
            hourlyDataEl.innerHTML = html;
        }

        // Handle Enter key in input fields
        document.getElementById('latitude').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') runPrediction();
        });
        
        document.getElementById('longitude').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') runPrediction();
        });

        // Handle window resize for chart
        window.addEventListener('resize', function() {
            if (predictionChart) {
                predictionChart.resize();
            }
        });

        // Initialize
        window.addEventListener('load', function() {
            console.log('Responsive Solar Predictor Ready!');
        });
    </script>
</body>
</html>